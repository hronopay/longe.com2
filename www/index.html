<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<!--link rel="stylesheet" type="text/css" href="css/firstpage.css" /-->
<script src="js/external/jquery/jquery.js"></script>
<script src="js/jquery-ui.js"></script>
<link href="../css/jquery-ui.css" rel="stylesheet">

<script type="text/javascript">
    var signupCss = '<link rel="stylesheet" type="text/css" href="../css/signup.css" />';
    var firstPageCss = '<link rel="stylesheet" type="text/css" href="../css/firstpage.css" />';
    var str = window.location.pathname.replace("/","");
    if(str=='index.html') str='';
    console.log( str );

    if(str=='signup') $('head').append(signupCss); //signupCss;
    else if(str=='firstpage' || str=='') $('head').append(firstPageCss); //firstPageCss;
    else $('head').append(''); //nothing;
 
    $.ajax({
        url: "locale.php", // $_COOKIE["lang"] = '' 
        cache: false,
        success: function(html){
            $('#locale_sec').html(html);
            console.log('#1 done (locale on load)');
        }
    });


 $(document).on('change', '#selectmenu', function() {
    var selected = $(this).val();
    var action = '';

    $.ajax({
        url: "locale.php",  //   $_COOKIE["lang"] = selected
        type: 'POST',
        data: {
            action: 'locale.php',       //  no use
            setCookie: selected     //  setcookie("lang",selected);
        },
        //beforeSend: function(xhr) {},
        success: function(html){
            $('#locale_sec').html(html);
            show_content();
            console.log('#2 done (locale on change)');
        },
        error: function() {
            alert('Error');
        }
    });
});

    

    function show_content(){
        var langvalue = '';
        //if($('select').is("#selectmenu")) langvalue = $('#selectmenu').val();
        if($('select').is("#selectmenu")) langvalue = $('#selectmenu option:selected').val();
        $.ajax({
            url: 'api.php',
            type: 'POST',
            cache: false,
            data: {
                action: 'api.php/'+str,       //  no use
                langv: langvalue,        //  add lang_'langvalue'.php  
                page: str
            },
            success: function(html){
                $('#content_sec').html(html);
                console.log('#3 done ( show_content(); )');
            },
            error: function() {
                alert('Error #3');
            }
        });
    }

/*     function show_content(){
        $( "#locale_sec" ).load( show_content_old() );
    }
 */
    //    setInterval('show()', 3000);
    
</script>


</head>
<body onload="show_content()">
    <section id="locale_sec"></section>
    <section id="content_sec"></section>
</body>
</html>


